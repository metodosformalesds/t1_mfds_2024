{% extends "base.html" %}

{% block content %}
<div class="container mx-auto py-8 px-4 sm:px-6 lg:px-8">
    <!-- Título del chat -->
    <a href="{{ url_redireccion }}" class="flex items-center text-black pb-4">
        <svg class="mr-2" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M10.854 4.146a.5.5 0 0 1 0 .708L7.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0z"/>
        </svg>
        Regresar
    </a>
    <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Mis Chats</h1>

    <!-- Contenedor de chats -->
    <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
        {% for chat in chats %}
            <!-- Card de chat individual -->
            <a href="{% url 'ver_chat' chat.id %}" class="block p-4 border rounded-lg hover:bg-blue-50 transition duration-150 ease-in-out">
                <div class="flex items-center space-x-4">
                    <!-- Mostrar imagen de la herramienta o imagen predeterminada -->
                    <div class="w-16 h-16 flex-shrink-0 rounded-lg bg-cover bg-center bg-no-repeat" style='background-image: url("{% if chat.herramienta.imagenes %}{{ chat.herramienta.imagenes.url }}{% else %}https://cdn.usegalileo.ai/sdxl10/84ed65ba-6d8e-4158-b97a-6d36dabc415d.png{% endif %}");'></div>
                    <!-- Información del chat -->
                    <div class="flex-1">
                        <div class="flex justify-between items-center">
                            <p class="text-lg font-semibold text-gray-900">{{ chat.herramienta.nombre }}</p>
                            <p class="text-xs text-gray-500">{{ chat.creado|date:"d/m/Y H:i" }}</p> <!-- Fecha y hora de creación del chat -->
                        </div>
                        <p class="text-sm text-gray-600 mt-1">
                            <span class="font-medium">Con: {% if request.user == chat.arrendatario.usuario %}{{ chat.arrendador.nombre }}{% else %}{{ chat.arrendatario.nombre }}{% endif %}</p></span>
                            {% if chat.arrendatario.usuario == request.user %}
                                {{ chat.arrendador.usuario.get_full_name }}
                            {% else %}
                                {{ chat.arrendatario.usuario.get_full_name }}
                            {% endif %}
                        </p>
                    </div>
                </div>
            </a>
        {% empty %}
        <!-- Mensaje si no hay chats -->
        <div class="text-center py-8">
            <p class="text-gray-600 text-lg">No tienes chats activos.</p>
            <p class="text-gray-400 text-sm">Empieza una conversación alquilando una herramienta.</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
