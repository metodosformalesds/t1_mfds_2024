{% extends "base.html" %}
{% load widget_tweaks %}

{% block content %}
<div class="relative flex size-full min-h-screen flex-col bg-slate-50 group/design-root overflow-x-hidden">
    <div class="layout-container flex h-full grow flex-col">

        <!-- Mostrar mensajes -->
        {% if messages %}
        <div class="fixed top-4 right-4 z-50">
            {% for message in messages %}
            <div class="bg-green-500 text-white rounded-lg p-4 mb-2 shadow-lg">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <div class="px-40 flex flex-1 justify-center py-5">
            <div class="layout-content-container flex flex-col w-full max-w-[512px] py-5">
                <div class="flex flex-col gap-3 p-4">
                    <a href="{% url 'arrendador_home' %}" class="flex items-center text-black pb-4">
                        <svg class="mr-2" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M10.854 4.146a.5.5 0 0 1 0 .708L7.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0z"/>
                        </svg>
                        Regresar
                    </a>
                    <p class="text-[#0e141b] tracking-light text-[32px] font-bold leading-tight">Rentar nueva herramienta</p>
                    <p class="text-[#4e7397] text-sm font-normal leading-normal">Genera dinero rentando herramientas a otras personas.</p>
                </div>

                <!-- Formulario -->
                <form method="POST" enctype="multipart/form-data" class="space-y-6">
                    {% csrf_token %}
                    <div class="flex flex-col gap-4 px-4">
                        <!-- Nombre -->
                        <label class="flex flex-col">
                            <span class="text-[#0e141b] text-base font-medium pb-2">Nombre de la herramienta</span>
                            {{ form.nombre|add_class:"form-input placeholder-gray-500" }}
                            <span class="text-sm text-gray-500">Ejemplo: Taladro eléctrico, Sierra circular...</span>
                        </label>
                        <!-- Descripción -->
                        <label class="flex flex-col">
                            <span class="text-[#0e141b] text-base font-medium pb-2">Describe tu herramienta</span>
                            {{ form.descripcion|add_class:"form-input placeholder-gray-500" }}
                            <span class="text-sm text-gray-500">Ejemplo: Herramienta en excelentes condiciones para trabajos de construcción.</span>
                        </label>
                        <!-- Costo -->
                        <label class="flex flex-col">
                            <span class="text-[#0e141b] text-base font-medium pb-2">Costo de alquiler por día</span>
                            {{ form.costo_dia|add_class:"form-input placeholder-gray-500" }}
                            <span class="text-sm text-gray-500">Ejemplo: $50.00</span>
                        </label>
                        <script>
                            document.querySelector('input[name="costo_dia"]').setAttribute('min', '1');
                        </script>
                        
                        
                        <!-- Categoría -->
                        <label class="flex flex-col">
                            <span class="text-[#0e141b] text-base font-medium pb-2">Categoría</span>
                            {{ form.categoria|add_class:"form-input placeholder-gray-500" }}
                        </label>
                        <!-- Imágenes -->
                        <label class="flex flex-col">
                            <span class="text-[#0e141b] text-base font-medium pb-2">Imágenes</span>
                            {{ form.imagenes|add_class:"form-input placeholder-gray-500" }}
                            <span class="text-sm text-gray-500">Sube imágenes de buena calidad que muestren tu herramienta claramente.</span>
                            <img id="imagePreview" class="mt-4 w-full h-48 object-cover rounded-lg hidden" alt="Vista previa de la imagen" />
                        </label>
                    </div>
                    <div class="flex justify-center px-4 py-3">
                        <button type="submit" class="flex w-full max-w-[480px] items-center justify-center rounded-xl h-12 px-6 bg-[#1980e6] text-white text-base font-bold hover:bg-[#156ac2] transition-all">
                            Crear publicación
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    document.querySelector('input[type="file"]').addEventListener('change', function(event) {
        const file = event.target.files[0];
        const preview = document.getElementById('imagePreview');

        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                preview.classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        } else {
            preview.src = '';
            preview.classList.add('hidden');
        }
    });
</script>
{% endblock %}
